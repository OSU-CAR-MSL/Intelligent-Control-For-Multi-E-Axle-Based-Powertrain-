# Overview
The intelligent control of heavy-duty electric vehicles consists of three steps. In the first step, the strategy leverages information about upcoming driving conditions (e.g., speed limits, road grade, and lead vehicle behavior) to adjust vehicle speed optimally, which leads to reduced energy consumption while balancing travel time. The second step operates at the powertrain level, optimally distributing torque among multiple e-axles to minimize powertrain losses. Finally, the third step focuses on component-level control, ensuring each electric machine operates in a synchronized manner, even under uneven torque allocation, to guarantee safe and reliable vehicle operation. 
<p align="center"><img width="718" height="330" alt="image" src="https://github.com/user-attachments/assets/f1ca4fe5-0a4e-4507-946d-e64db335a978" />Overview of Control Scheme</em>
  
# Step 1: Vehicle Level Optimization 
This step formulates a cost function that combines the vehicleâ€™s energy consumption with the speed tracking error, where the speed limit serves as the reference. A penalty factor is introduced to adjust the trade-off, allowing emphasis to be placed either on minimizing energy use or on maintaining speed tracking. The strategy leverages look-ahead information, including upcoming road grade, speed limits, and the behavior of a lead vehicle, over a defined time horizon, which is further divided into smaller segments to capture variations in the input data. Within each segment, the cost function is evaluated, and optimization techniques are applied to determine the optimal acceleration that minimizes the overall cost across the horizon. In order to solve this problem, gradient-based optimization methods are employed, and the performance of sequential quadratic programming (SQP), interior-point (IP) methods, and dynamic programming (DP) are compared. The resulting optimal acceleration is then used to compute the required driving torque. The choice of penalty factor is particularly critical for heavy-duty electric vehicles. A higher penalty on speed tracking error reduces travel delays but can increase energy usage, while prioritizing energy minimization may extend delivery time and raise operational costs. This research therefore also addresses the optimal selection of the penalty factor, ensuring a balanced trade-off between energy efficiency and travel time.

# Step 2: Torque Allocation To Multi E-Axles 
This step operates at the powertrain level, where it receives the optimal driving torque from Step I along with the current vehicle speed. A cost function is then formulated to capture the power losses of key drivetrain components, including the traction electric machines (EMs), gearbox, and differential. Based on this cost function, the controller determines the optimal torque allocation for each e-axle to minimize overall powertrain losses. Similar to Step I, this strategy employs gradient-based optimization techniques to solve the optimal control problem. My published and ongoing  on this approach utilize sequential quadratic programming (SQP), interior-point (IP) methods, and dynamic programming (DP) to evaluate performance, consistently demonstrating the effectiveness of this control strategy. Unlike conventional supervisory powertrain controllers, however, these methods may sometimes recommend uneven torque splits across e-axles. While effective in reducing losses, this uneven distribution can introduce challenges in maintaining synchronized operation between the e-axles, highlighting the need for advanced coordination mechanisms.
# Step 3: Synchronizing Operation of Traction Electric Machines
At this stage, the impact of optimal torque allocation on traction electric machines (EMs) is addressed, as uneven torque distribution can result in different operating speeds and thermal stresses across the EMs. For safe and reliable vehicle operation, the EMs must remain synchronized in speed. To achieve this, the control strategy assigns adjusted speed references to each EM to ensure coordinated operation.
My research introduces two key novelties at this level. First, it employs machine learning techniques to model and predict EM dynamics, specifically the actual speed response at given torque and speed requests. The predicted responses of all EMs are then compared; if any EM is found to deviate from synchronized operation, its speed reference is adjusted to restore consistency. Second, I propose a physics-informed neural network (PINN)-based parameter estimation method for EMs, which is not currently present in the literature. In this approach, the PINN simultaneously learns EM parameters and network weights while enforcing physical constraints. The learned parameters are then used to reconstruct EM dynamics and verify convergence. If convergence is not achieved, the learning process is reiterated until accurate synchronization is ensured. By integrating this step with the previous levels of optimization, the proposed framework reduces the overall energy consumption of heavy-duty electric vehicles and extends their driving range.
